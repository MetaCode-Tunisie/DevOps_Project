pipeline{
    agent any
    stages {
        stage(" Maven Test "){
            steps {
                sh "mvn -version"
            }
        }
        stage("JDK Test "){
            steps {
                sh "java -version"
            }
        }
        stage("Getting Projet From Git"){
            steps {
                echo "Pulling"
            }
        }
        stage('Cleaning & Compiling') {
            steps{
                sh 'mvn clean compile'

        }
}
     stage('SonarQube CodeQuality Check') {
            steps{
                sh 'mvn sonar:sonar -Dsonar.login=admin -Dsonar.password=sonar'
            }
        }

  stage('Unit Test') {
            steps {
                // Use Maven to run your JUnit tests
                sh 'mvn test'
            }
        }

  stage('Artifact construction') {
                    steps {
                        // Assurez-vous que Maven est install√© dans le chemin (PATH)
                        script {
                            def mvnHome = tool name: 'Maven', type: 'Tool'
                            if (isUnix()) {
                                sh "${mvnHome}/bin/mvn package"
                            } else {
                                bat "${mvnHome}\\bin\\mvn package"
                                   }
          }
         }
 }
        }

    }
}
